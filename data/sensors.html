<!DOCTYPE html><html><head><title>(Type a title for your page here)</title><style>.ontop{z-index:999;width:100%;height:100%;top:0;left:0;display:none;position:absolute;background-color:#636363;color:#aaa;opacity:.4}#popup{width:250px;height:100px;position:absolute;color:#000;background-color:#fff;border-radius:10px;top:50%;left:50%;margin-left:-125px;margin-top:-50px}.modal{display:none;position:fixed;z-index:1;padding-top:100px;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:rgba(0,0,0,.4)}.modal-content{background-color:#fefefe;margin:auto;padding:20px;border:1px solid #888;width:80%}.close{color:#aaa;float:right;font-size:28px;font-weight:700}.close:focus,.close:hover{color:#000;text-decoration:none;cursor:pointer}#popupchild{position:absolute;top:10%;left:10%;height:80%;width:80%}#head{background:#313230;-moz-border-radius-topright:10px;border:0;margin:10px auto 0 auto;padding:5px 30px}#content{padding:20px;background:#fff repeat-x 0 -28px}body{background-color:#add8e6;color:#333;font:13px/1.5 'Helvetica Neue',Arial,'Liberation Sans',FreeSans,sans-serif;margin:0}h1{color:#fff;font-size:25px;display:block;font-size:2em;font-weight:700;margin-bottom:0;margin-top:0}h2{background-image:linear-gradient(white,#ddd);border-bottom:1px solid;border-color:#ddd;margin-bottom:0;margin-top:0;padding:0 10px}p{padding:0 10px}#navigation{background:#434a48;color:#fff;padding:10px 30px}#navigation .active{background:#687370}#navigation a:hover{background:#232323}#navigation>li{display:inline;margin:0}#navigation>li>span{display:inline-block;padding:5px 10px;text-decoration:none;font-family:"Helvetica Neue",Arial,"Liberation Sans",FreeSans,sans-serif;font-weight:700}#navigation>li>a,#navigation>li>span{display:inline-block;padding:5px 10px;text-decoration:none;font-family:"Helvetica Neue",Arial,"Liberation Sans",FreeSans,sans-serif;font-weight:700}ul{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0;-webkit-padding-start:40px}li{margin-left:30px}#navigation span{-moz-border-radius-bottomleft:5px;-moz-border-radius-topright:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-right-radius:5px}#navigation a{-moz-border-radius-bottomleft:5px;-moz-border-radius-topright:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-right-radius:5px;color:#fff;text-decoration:underline;cursor:auto}.box{background:#fff;border:1px solid;padding:5px 0;background:#fff;border-color:#eee;margin-bottom:10px;-moz-border-radius-bottomright:5px;-moz-border-radius-topleft:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topright:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-top-left-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-right-radius:5px}table{width:100%}td,th{padding:7px 15px;text-align:left;color:#333;font:13px/1.5 'Helvetica Neue',Arial,'Liberation Sans',FreeSans,sans-serif;background-image:linear-gradient(#fafafa,#fff)}#foot{background:#313230;-moz-border-radius-topright:10px;border:0;margin:10px auto 0 auto;padding:5px 30px}.hvr-underline-from-center{display:inline-block;vertical-align:middle;-webkit-transform:perspective(1px) translateZ(0);transform:perspective(1px) translateZ(0);box-shadow:0 0 1px transparent;position:relative;overflow:hidden}.hvr-underline-from-center:before{content:"";position:absolute;z-index:-1;left:50%;right:50%;bottom:0;background:#2098d1;height:4px;-webkit-transition-property:left,right;transition-property:left,right;-webkit-transition-duration:.3s;transition-duration:.3s;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out}.hvr-underline-from-center:active:before,.hvr-underline-from-center:focus:before,.hvr-underline-from-center:hover:before{left:0;right:0}label.input-toggle{line-height:0;font-size:0;display:inline-block;margin:0}label.input-toggle>span{display:inline-block;position:relative;background-image:-webkit-linear-gradient(left,#848484 0,#848484 50%,#7cbcbf 50%,#7cbcbf 100%);background-image:linear-gradient(to right,#848484 0,#848484 50%,#7cbcbf 50%,#7cbcbf 100%);background-size:64px 14px;background-position:0;border-radius:32px;width:32px;height:14px;cursor:pointer;-webkit-transition:background-position .2s ease-in;transition:background-position .2s ease-in}label.input-toggle>input:checked+span{background-position:-100%}label.input-toggle>span:after{content:"";display:block;position:absolute;width:18px;height:18px;background:#f1f1f1;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;top:50%;left:0;-webkit-transform:translateY(-50%);transform:translateY(-50%);border-radius:100%;box-shadow:0 1px 3px rgba(0,0,0,.5);-webkit-transition:left .2s ease-in,background-color .2s ease-in,-webkit-transform .3s ease;transition:left .2s ease-in,background-color .2s ease-in,-webkit-transform .3s ease;transition:left .2s ease-in,background-color .2s ease-in,transform .3s ease;transition:left .2s ease-in,background-color .2s ease-in,transform .3s ease,-webkit-transform .3s ease}label.input-toggle>input:checked+span:after{left:calc(100% - 18px);background-color:#1d8b90}label.input-toggle>span:active:after{-webkit-transform:translateY(-50%) scale3d(1.15,.85,1);transform:translateY(-50%) scale3d(1.15,.85,1)}label.input-toggle>input:disabled+span:active:after{-webkit-transform:translateY(-50%);transform:translateY(-50%)}label.input-toggle>input:disabled+span{cursor:default}label.input-toggle>input:disabled+span{background:#d5d5d5}label.input-toggle>input:disabled+span:after{background:#bdbdbd}label.input-toggle>input{display:block;position:absolute;opacity:0;width:0;height:0}</style><script>function getUrlVars(){var e={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,n,o){e[n]=o}),e}function getJson(e,t){popFunction("Aggiornamento...");var n=new XMLHttpRequest;n.open("GET",e,!0),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onload=function(){if(this.status>=200&&this.status<400){var e=JSON.parse(this.response);document.getElementById("summary").innerHTML="json received"+JSON.stringify(e),t(e)}else alert("errore:"+this.status);hideFunction()},n.send()}function formInputToJSON(e){for(var t={},n=0,o=e.length;n<o;++n){var s=e[n];s.name&&("number"==s.type?t[s.name]=Number(s.value):"radio"==s.type&&s.checked?"0"==s.value?t[s.name]=!1:t[s.name]=!0:"checkbox"==s.type?s.checked?t[s.name]=!0:t[s.name]=!1:t[s.name]=s.value)}return t}function sendCommand(e,t){var n=new XMLHttpRequest;n.open("POST",commandPath,!0),n.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n.send(JSON.stringify(e)),document.getElementById("command").innerHTML="command sent"+JSON.stringify(e),document.getElementById("summary").innerHTML="",n.onloadend=function(){hideFunction(),result=n.responseText;var e=JSON.parse(result);document.getElementById("summary").innerHTML="comman received"+JSON.stringify(e),t(e)},popFunction("Invio comando in corso...")}var serverPath=".",heaterStatusPath=serverPath+"/heaterstatus",sensorsStatusPath=serverPath+"/shield?command=updatesensorstatusrequest",commandPath=serverPath+"/shield",settingsPath=serverPath+"/shield?command=updatesettingstatusrequest",popFunction=function(e,t,n){document.getElementById("modalPopup").style.display="block",document.getElementById("modalText").innerHTML=e,document.getElementById("okButton"),document.getElementById("cancelButton"),null!=t?(document.getElementById("okButton").style.display="block",document.getElementById("okButton").onclick=t):document.getElementById("okButton").style.display="none";var o=document.getElementsByClassName("close")[0];null!=n?(document.getElementById("cancelButton").style.display="block",document.getElementById("cancelButton").onclick=n,o.style.display="block",o.onclick=function(){hideFunction()},window.onclick=function(e){e.target==modal&&hideFunction()}):(o.style.display="none",document.getElementById("cancelButton").style.display="none")},hideFunction=function(){document.getElementById("modalPopup").style.display="none"};document.onkeydown=function(e){e=e||window.event,27==e.keyCode&&hideFunction("popDiv")}</script><script>function load(){shieldId=getUrlVars().id,sensorDiv=document.getElementById("sensor"),genericSensorDiv=document.getElementById("genericsensor"),temperatureDiv=document.getElementById("onewiresensor"),doorDiv=document.getElementById("doorsensor"),listDiv=document.getElementById("sensorList"),getJson(sensorsStatusPath+"&id="+shieldId,refreshFunction)}function addSensor(e){var n=sensorDiv.cloneNode(!0);return n.style.display="block",n.getElementsByTagName("input").deleteButton.addEventListener("click",function(){deleteSensor(n)},!1),null!=e&&(n.getElementsByTagName("h2")[0].innerHTML="Sensore "+e.name,n.getElementsByTagName("input").enabled.checked=!0,n.getElementsByTagName("input").name.value=e.name,n.getElementsByTagName("select").sensorTypeSelect.value=e.type,n.getElementsByTagName("select").pin.value=e.pin),n.getElementsByTagName("select").sensorTypeSelect.addEventListener("change",function(){onChangeSensorType(this)},!1),div=n.getElementsByTagName("div").sensorproperties,null!=e?addSensorProperties(div,e.type,e):addSensorProperties(div,"onewiresensor",null),listDiv.appendChild(n),n}function addSensorProperties(e,n,s){"onewiresensor"==n?addTemperatureProperties(e,s):e.innerHTML=""}function addTemperatureProperties(e,n){var s=temperatureDiv.cloneNode(!0);addSubTemperatureSensor(s,n),s.style.display="block",e.innerHTML="",e.appendChild(s)}function addSubTemperatureSensor(e,n){subSensorDiv=e.getElementsByTagName("div").subsensor,subSensorList=e.getElementsByTagName("div").subsensorlist,subSensorList.innerHTML="";var s=1;if(null!=n){for(i=0;i<n.childsensors.length;i++)newsubdiv=subSensorDiv.cloneNode(!0),newsubdiv.getElementsByTagName("input").name.value=n.childsensors[i].name,subSensorDiv.style.display="block",subSensorList.appendChild(newsubdiv);s=i}else newsubdiv=subSensorDiv.cloneNode(!0),newsubdiv.getElementsByTagName("input").name.value="nome",subSensorDiv.style.display="block",subSensorList.appendChild(newsubdiv),s=1;var t=e.getElementsByTagName("input").temperatureSensorNumber;t.addEventListener("input",function(){})}function onChangeSensorType(e){type=e.value,div=e.parentNode.getElementsByTagName("div").sensorproperties,addSensorProperties(div,type,null)}function deleteSensor(e){e.parentNode.removeChild(e)}function save(){list=listDiv.getElementsByClassName("box");var e={command:"updatesensorlist",shieldid:shieldId,sensors:[]};for(i=0;i<list.length;i++){var n=list[i],s=n.getElementsByTagName("select").sensortype.value,t=n.getElementsByTagName("select").pin.value,r=n.getElementsByTagName("input").name.value,o=n.getElementsByTagName("input").enabled.checked,a=i+1;if("onewiresensor"==s)for(properties=n.getElementsByTagName("div").sensorproperties,subsensorlist=properties.getElementsByClassName("subsensorbox"),e.sensors.push({name:r,type:s,enabled:o,pin:t,addr:a,childsensors:[]}),k=0;k<subsensorlist.length;k++){var d=(subsensorlist[k].getElementsByTagName("input").name.value,{name:"childname",id:k+1,enabled:!0,pin:t,addr:""+a+"."+(k+1),type:"temperaturesensor"});e.sensors[i].childsensors.push(d)}else"doorsensor"==s?e.sensors.push({name:r,type:s,enabled:o,addr:""+a,pin:t}):e.sensors.push({name:r,type:s,enabled:o,addr:a,pin:t})}sendCommand(e,commandResponse)}function commandResponse(e){document.getElementById("command").innerHTML+="command result"+JSON.stringify(e),getJson(sensorsStatusPath+"&id="+shieldId,refreshFunction)}var sensorDiv,listDiv,temperatureDiv,doorDiv,genericSensorDiv,shieldId=0,refreshFunction=function(e){for(listDiv.innerHTML="",j=0;j<e.sensors.length;j++)div=addSensor(e.sensors[j]);document.getElementById("addSensorButton").addEventListener("click",function(){addSensor(null)},!1),document.getElementById("saveButton").addEventListener("click",function(){save()},!1),sensorDiv.style.display="none",temperatureDiv.style.display="none",doorDiv.style.display="none",genericSensorDiv.style.display="none"}</script></head><body><div id="modalPopup" class="modal"><div class="modal-content"><span class="close">&times;</span><div id="modalText">Some text in the Modal..</div><input type="button" id="okButton" value="Ok"> <input type="button" id="cancelButton" value="Annulla"></div></div><h1 id="head">Webduino</h1><ul id="navigation"><li><a href="index.html" class="button hvr-underline-from-center">Home</a></li><li><a href="settings.html" class="button hvr-underline-from-center">Impostazioni</a></li><li><a href="heater.html" class="button hvr-underline-from-center">Riscaldamento</a></li><li><span class="active">Sensori</span></li></ul><div id="content" class="container_16 clearfix"><div class="grid_5" id="sensors"><div class="box" id="sensor" name="sensor"><h2>Sensore n#</h2><strong>Abilitato :</strong><label class="input-toggle"><input type="checkbox" id="sensorEnabledCheckBox" name="enabled" checked="true"><span></span></label><br><strong>nome sensore: </strong><input type="text" name="name"><br><strong>pin :</strong><select id="pin" name="pin"><option value="D0">D0</option><option value="D1">D1</option><option value="D2">D2</option><option value="D3">D3</option><option value="D4">D4</option><option value="D5">D5</option><option value="D6">D6</option><option value="D7">D7</option><option value="D8">D8</option><option value="D9">D9</option><option value="D10">D10</option><option value="A0">A0</option></select><br><strong>tipo sensore :</strong><select id="sensorTypeSelect" name="sensortype"><option value="onewiresensor">Sensore OneWire</option><option value="doorsensor">Sensore porta</option><option value="currentsensor">Sensore corrente</option><option value="humiditysensor">Sensore di umidit&agrave;</option><option value="pressuresensor">Sensore di pressione</option><option value="pirsensor">Sensore di presenza</option><option value="heatersensor">Riscaldamento</option><option value="relesensor">Rel&egrave;</option></select><br><div class="subsensorbox" id="sensorproperties" name="sensorproperties"><strong>genric: </strong><input type="number" name="subSensorNumber" min="1" max="10" step="1"></div><br><input type="button" id="deleteButton" value="Elimina sensore"></div><br><sensorsnsor custom="" properties="" -="" questi="" sono="" i="" template="" delle="" proprietà="" dei="" sensori--=""><div id="genericsensor" name="genericsensor"><strong>no custom properties</strong></div><div id="onewiresensor" name="onewiresensor"><strong>numero sensori: </strong><input type="number" name="temperatureSensorNumber" min="1" max="10" step="1" value="1"><div name="subsensorlist"><div class="subsensorbox" name="subsensor"><input type="hidden" name="addr" value="0"> <strong>#: </strong><input type="text" name="name" value="prova"><br></div></div></div><div id="doorsensor" name="doorsensor"><strong>door: </strong><input type="number" name="subSensorNumber" min="1" max="10" step="1"></div><sensorsnsor custom="" properties="" end--=""><div id="sensorList"></div><input type="button" id="addSensorButton" value="Aggiungi sensore"> <input type="button" id="saveButton" value="Salva configurazione"></sensorsnsor></sensorsnsor></div></div><div id="foot"><div class="container_16 clearfix"><div class="grid_16"><a href="#">Contact Me</a></div></div></div><label id="summary">summary</label><br><label id="command">command</label><br><label id="timer">timer</label><script type="text/javascript">document.addEventListener("DOMContentLoaded",function(){load()})</script></body></html>